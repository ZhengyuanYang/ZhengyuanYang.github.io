

<!DOCTYPE html>
<html lang="en" data-default-color-scheme=auto>



<head>
  <meta charset="UTF-8">
  <link rel="apple-touch-icon" sizes="76x76" href="/img/myico.png">
  <link rel="icon" href="/img/myico.png">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=5.0, shrink-to-fit=no">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  
  <meta name="theme-color" content="#2f4154">
  <meta name="author" content="John Doe">
  <meta name="keywords" content="">
  
    <meta name="description" content="This article summaries commonly used loss function in machine learning">
<meta property="og:type" content="article">
<meta property="og:title" content="Common Loss Function in Machine Learning">
<meta property="og:url" content="http://example.com/2022/09/22/loss-function/index.html">
<meta property="og:site_name" content="ZY&#39;s Blog">
<meta property="og:description" content="This article summaries commonly used loss function in machine learning">
<meta property="og:locale" content="en_US">
<meta property="og:image" content="http://example.com/2022/09/22/loss-function/1.png">
<meta property="og:image" content="http://example.com/2022/09/22/loss-function/2.png">
<meta property="og:image" content="http://example.com/2022/09/22/loss-function/3.png">
<meta property="og:image" content="http://example.com/2022/09/22/loss-function/4.png">
<meta property="og:image" content="http://example.com/2022/09/22/loss-function/5.png">
<meta property="article:published_time" content="2022-09-22T16:11:02.000Z">
<meta property="article:modified_time" content="2022-09-30T22:49:46.540Z">
<meta property="article:author" content="John Doe">
<meta property="article:tag" content="Loss Function">
<meta name="twitter:card" content="summary_large_image">
<meta name="twitter:image" content="http://example.com/2022/09/22/loss-function/1.png">
  
  
  <title>Common Loss Function in Machine Learning - ZY&#39;s Blog</title>

  <link  rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4/dist/css/bootstrap.min.css" />


  <link  rel="stylesheet" href="https://cdn.jsdelivr.net/npm/github-markdown-css@4/github-markdown.min.css" />
  <link  rel="stylesheet" href="https://cdn.jsdelivr.net/npm/hint.css@2/hint.min.css" />

  
    
    
      
      <link  rel="stylesheet" href="https://cdn.jsdelivr.net/npm/highlight.js@10/styles/github-gist.min.css" />
    
  

  
    <link  rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@3/dist/jquery.fancybox.min.css" />
  


<!-- 主题依赖的图标库，不要自行修改 -->

<link rel="stylesheet" href="//at.alicdn.com/t/font_1749284_ba1fz6golrf.css">



<link rel="stylesheet" href="//at.alicdn.com/t/font_1736178_lbnruvf0jn.css">


<link  rel="stylesheet" href="/css/main.css" />

<!-- 自定义样式保持在最底部 -->


  <script id="fluid-configs">
    var Fluid = window.Fluid || {};
    var CONFIG = {"hostname":"example.com","root":"/","version":"1.8.14","typing":{"enable":true,"typeSpeed":70,"cursorChar":"_","loop":false},"anchorjs":{"enable":true,"element":"h1,h2,h3,h4,h5,h6","placement":"right","visible":"hover","icon":""},"progressbar":{"enable":true,"height_px":3,"color":"#29d","options":{"showSpinner":false,"trickleSpeed":100}},"copy_btn":true,"image_zoom":{"enable":true,"img_url_replace":["",""]},"toc":{"enable":true,"headingSelector":"h1,h2,h3,h4,h5,h6","collapseDepth":0},"lazyload":{"enable":true,"loading_img":"/img/loading.gif","onlypost":false,"offset_factor":2},"web_analytics":{"enable":false,"baidu":null,"google":null,"gtag":null,"tencent":{"sid":null,"cid":null},"woyaola":null,"cnzz":null,"leancloud":{"app_id":null,"app_key":null,"server_url":null,"path":"window.location.pathname","ignore_local":false}},"search_path":"/local-search.xml"};
  </script>
  <script  src="/js/utils.js" ></script>
  <script  src="/js/color-schema.js" ></script>
<meta name="generator" content="Hexo 6.0.0"></head>


<body>
  <header style="height: 70vh;">
    <nav id="navbar" class="navbar fixed-top  navbar-expand-lg navbar-dark scrolling-navbar">
  <div class="container">
    <a class="navbar-brand" href="/">
      <strong>ZY&#39;s Blog</strong>
    </a>

    <button id="navbar-toggler-btn" class="navbar-toggler" type="button" data-toggle="collapse"
            data-target="#navbarSupportedContent"
            aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
      <div class="animated-icon"><span></span><span></span><span></span></div>
    </button>

    <!-- Collapsible content -->
    <div class="collapse navbar-collapse" id="navbarSupportedContent">
      <ul class="navbar-nav ml-auto text-center">
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/">
                <i class="iconfont icon-home-fill"></i>
                Home
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/categories/">
                <i class="iconfont icon-category-fill"></i>
                Categories
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/tags/">
                <i class="iconfont icon-tags-fill"></i>
                Tags
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/about/">
                <i class="iconfont icon-user-fill"></i>
                About me
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/archives/">
                <i class="iconfont icon-archive-fill"></i>
                Archives
              </a>
            </li>
          
        
        
          <li class="nav-item" id="search-btn">
            <a class="nav-link" target="_self" href="javascript:;" data-toggle="modal" data-target="#modalSearch" aria-label="Search">
              &nbsp;<i class="iconfont icon-search"></i>&nbsp;
            </a>
          </li>
        
        
          <li class="nav-item" id="color-toggle-btn">
            <a class="nav-link" target="_self" href="javascript:;" aria-label="Color Toggle">&nbsp;<i
                class="iconfont icon-dark" id="color-toggle-icon"></i>&nbsp;</a>
          </li>
        
      </ul>
    </div>
  </div>
</nav>

    <div class="banner" id="banner" parallax=true
         style="background: url('/img/default.png') no-repeat center center;
           background-size: cover;">
      <div class="full-bg-img">
        <div class="mask flex-center" style="background-color: rgba(0, 0, 0, 0.3)">
          <div class="page-header text-center fade-in-up">
            <span class="h2" id="subtitle" title="Common Loss Function in Machine Learning">
              
            </span>

            
              <div class="mt-3">
  
  
    <span class="post-meta">
      <i class="iconfont icon-date-fill" aria-hidden="true"></i>
      <time datetime="2022-09-22 09:11" pubdate>
        September 22, 2022 am
      </time>
    </span>
  
</div>

<div class="mt-1">
  
    <span class="post-meta mr-2">
      <i class="iconfont icon-chart"></i>
      4k 字
    </span>
  

  

  
  
    
      <!-- 不蒜子统计文章PV -->
      <span id="busuanzi_container_page_pv" style="display: none">
        <i class="iconfont icon-eye" aria-hidden="true"></i>
        <span id="busuanzi_value_page_pv"></span> 次
      </span>
    
  
</div>

            
          </div>

          
        </div>
      </div>
    </div>
  </header>

  <main>
    
      

<div class="container-fluid nopadding-x">
  <div class="row nomargin-x">
    <div class="d-none d-lg-block col-lg-2"></div>
    <div class="col-lg-8 nopadding-x-md">
      <div class="container nopadding-x-md" id="board-ctn">
        <div class="py-5" id="board">
          <article class="post-content mx-auto">
            <!-- SEO header -->
            <h1 style="display: none">Common Loss Function in Machine Learning</h1>
            
            <div class="markdown-body">
              <h1 id="common-loss-function-in-machine-learning">Common Loss Function in Machine Learning</h1>
<h2 id="numerical-output">Numerical Output</h2>
<h3 id="msel2-lossrmse">1. MSE(L2 Loss)/RMSE</h3>
<p>Mean Squared Error <span class="math display">\[
MSE = \frac{1}{n}\sum_i^n(y_i-\hat{y})^2
\]</span></p>
<ul>
<li>MSE is differentiable any where, which makes it suitable for gradient descent optimizer</li>
<li>With gradient decrease, the MSE will decrease, which means MSE is effective with fixed learning rate</li>
<li>The squared operator gives enlarge the loss, thus MSE is sensitive ti outlier, if outlier is meant to be detected, suing MSE is fine. If the outlier is treat as part of the training data, MSE is not an ideal loss function (e. g. prediction model for sales promotion day)</li>
</ul>
<p><img src="/2022/09/22/loss-function/1.png" srcset="/img/loading.gif" lazyload></p>
<p>RMSE is the square root of MSE <span class="math display">\[
RMSE = \sqrt{MSE}
\]</span></p>
<ul>
<li>RMSE is on the same scale with MSE, but it make the loss more interpretable in some case(e.g prediction on product price)</li>
</ul>
<h3 id="mae-l1-lossmape">2. MAE (L1 Loss)/MAPE</h3>
<p>Mean Absolute Error <span class="math display">\[
MAE = \frac{1}{n}\sum_i^n|y_i-\hat{y}|
\]</span></p>
<ul>
<li>MAE is not sensitive to outlier, it is less likely to cause gradient explosion</li>
<li>The gradient for any loss is the same, which means MAE does not converge well with fix learning rate</li>
<li>MAE is not differentiable at 0</li>
</ul>
<p><img src="/2022/09/22/loss-function/2.png" srcset="/img/loading.gif" lazyload></p>
<p>MAPE is the mean percentage absolute error <span class="math display">\[
MAE = \frac{1}{n}\sum_i^n\frac{|y_i-\hat{y}|}{y_ i}
\]</span></p>
<ul>
<li>It can more clearly deliver the degree of deviation rather than the scale of the error</li>
</ul>
<h3 id="smooth-l1huber-loss">3. Smooth L1(Huber Loss)</h3>
<p><span class="math display">\[
L = \frac{1}{n}\sum_i^nz_ i
\\
z_i = \left\{
\begin{aligned}
MSE \qquad&amp; |y -\hat{y}| &lt; \beta \\
MAE \qquad &amp; elsewhere \\
\end{aligned}
\right.
\]</span></p>
<ul>
<li><span class="math inline">\(\beta\)</span> is a defined threshold for error of outlier. If the error is within <span class="math inline">\(\beta\)</span>, apply MSE, otherwise, apply MAE. Huber Loss combines the advantages of L1 and L2 Loss</li>
<li>Huber loss is ideal for NN</li>
</ul>
<p><img src="/2022/09/22/loss-function/3.png" srcset="/img/loading.gif" lazyload></p>
<h3 id="log-cosh-loss">4. Log-cosh Loss</h3>
<p><span class="math display">\[
L = \sum_ i^ nlog(cosh(y_i-\hat{y_i}))
\]</span></p>
<ul>
<li>Log-cosh has almost every virtue of Huber loss, the difference is, it is second-differentiable anywhere, such method is very useful when applying newton-method optimzer</li>
<li>However, when erro is very big, Log-cosh loss still would have gradient or hessian problem(gradient remains same when loss decrease). Just like MAE</li>
</ul>
<h2 id="categoricalprobability-output">Categorical/Probability Output</h2>
<h3 id="log-losscross-entropy-loss">1. Log Loss/Cross Entropy Loss</h3>
<p>Log Loss is basically the same concept as the cross entropy, the only difference is that it can be applied at a single sample by replaceing true probability p(x) with 1 if <span class="math inline">\(y_ {true} = m\)</span>. The average loss of all sample is the Log Loss or Cross Entropy Loss.</p>
<p>For Cross Entropy, refer to <a target="_blank" rel="noopener" href="http://zhengyuanyang.com/2022/09/22/information-theory-in-ML/">here</a></p>
<p>When it come to a binary classification scenario, the Log Loss can be written as: <span class="math display">\[
LogLoss = -\frac{1}{n}\sum_i^n [y_ilog(p(y_i))+(1-y_i)log(1-p(y_i))]
\]</span></p>
<ul>
<li>The gradient would decrease as Log Loss decrease, thus Log Loss can work with fixed learning rate</li>
<li>Sentive to outlier</li>
<li>GDBT usually apply Log Loss as loss function(classification)</li>
</ul>
<p>The following picture is the log loss of the prediction on a positive sample:</p>
<p><img src="/2022/09/22/loss-function/4.png" srcset="/img/loading.gif" lazyload></p>
<h3 id="exponential-loss">2. Exponential Loss</h3>
<p><span class="math display">\[
L = \frac{1}{n}\sum_i^ne^{-yf(x)}
\]</span></p>
<ul>
<li>Theoretically, the optimal of Exponential Loss and Log Loss is the same(<span class="math inline">\(\frac{1}{2}log\ odds\)</span>), the advantage of exponential loss is that is is easier to calculate, thus can make optimzer update the weight with less cost</li>
<li>Sentive to outlier</li>
<li>AdaBoosting usually apply Exponential Loss as loss function(classification)</li>
</ul>
<h3 id="hinge-loss">3. Hinge Loss</h3>
<p><span class="math display">\[
L = \frac{1}{n}\sum_i^n max(0,1-yf(x))
\]</span></p>
<ul>
<li>If the model label the sample correct, the loss is 0</li>
<li>Less sensitive to outlier</li>
<li>SVM usually adopt Hinge Loss as loss function</li>
</ul>
<p><img src="/2022/09/22/loss-function/5.png" srcset="/img/loading.gif" lazyload></p>
<h3 id="focal-loss">4. Focal Loss</h3>
<p>Focal Loss is a improved version of Cross Entrophy Loss <span class="math display">\[
L_ f = -\frac{1}{n}\sum_i^n\sum_ j^m\alpha_ j(1-p(y ))^\gamma y log(p(y))
\]</span></p>
<ul>
<li>Focal Loss add a focus factor <span class="math inline">\((1-p(y))\)</span>, so that those sample with high predicted probability, which are the ""easy samples", donate less loss. Compare to CE Loss, Focal Loss focus on those "hard samples"</li>
<li>Focal Loss also add a balance factor(optional), which is the percentage of a certain category of y among all samples. This make focal loss can deal with imbalanced data</li>
<li><span class="math inline">\(\gamma\)</span> is a influence parameter. When <span class="math inline">\(\gamma = 0\)</span>, the Focal Loss become CE Loss. In preactice, we usually set <span class="math inline">\(\gamma = 2\)</span></li>
</ul>
<h3 id="impurity">5.Impurity</h3>
<p>Impurity is a kind of loss functions usually applied in splitting in decision tree</p>
<h4 id="gini-impurity">5.1 Gini Impurity</h4>
<p><span class="math display">\[
I_G = 1- \sum_{i}^m P(Y=C_i)
\]</span></p>
<ul>
<li>Lower <span class="math inline">\(I_G\)</span> , better classification performance</li>
<li>For decision tree model, calculate <span class="math inline">\(I_G\)</span> for each split and use combined Gini Impurity(<span class="math inline">\(\sum I_G\)</span>) as loss of the spiltting</li>
</ul>
<h4 id="information-gain">5.2 Information Gain</h4>
<p>For details of Information Gain, refer to <a target="_blank" rel="noopener" href="http://zhengyuanyang.com/2022/09/22/information-theory-in-ML/">here</a> <span class="math display">\[
IG = H(Y) - H(Y|X)
\]</span> where X is the feature the spliting based on (X&gt;c,X=1)</p>
<ul>
<li>IG is the degree that uncertainty reduce after the spilting, the greater IG is, the better a split is</li>
<li>We can calculate the Information Gain Rate <span class="math inline">\(IGR = \frac{IG}{H(Y)}\)</span> to present the degress of uncertainty reduction more directly</li>
</ul>

            </div>
            <hr>
            <div>
              <div class="post-metas mb-3">
                
                  <div class="post-meta mr-3">
                    <i class="iconfont icon-category"></i>
                    
                      <a class="hover-with-bg" href="/categories/Machine-Learning/">Machine Learning</a>
                    
                  </div>
                
                
                  <div class="post-meta">
                    <i class="iconfont icon-tags"></i>
                    
                      <a class="hover-with-bg" href="/tags/Loss-Function/">Loss Function</a>
                    
                  </div>
                
              </div>
              
                <p class="note note-warning">
                  
                     All articles in this blog adpot <a target="_blank" href="https://creativecommons.org/licenses/by-sa/4.0/deed.zh" rel="nofollow noopener noopener">CC BY-SA 4.0 agreement unless otherwise specified</a>, please indicate the source！
                  
                </p>
              
              
                <div class="post-prevnext">
                  <article class="post-prev col-6">
                    
                    
                      <a href="/2022/09/22/information-theory-in-ML/">
                        <i class="iconfont icon-arrowleft"></i>
                        <span class="hidden-mobile">Information Theory in ML</span>
                        <span class="visible-mobile">Previous</span>
                      </a>
                    
                  </article>
                  <article class="post-next col-6">
                    
                    
                      <a href="/2022/09/21/Evaluation_Classification/">
                        <span class="hidden-mobile">Evaluation Method for Classification</span>
                        <span class="visible-mobile">Next</span>
                        <i class="iconfont icon-arrowright"></i>
                      </a>
                    
                  </article>
                </div>
              
            </div>

            
          </article>
        </div>
      </div>
    </div>
    
      <div class="d-none d-lg-block col-lg-2 toc-container" id="toc-ctn">
        <div id="toc">
  <p class="toc-header"><i class="iconfont icon-list"></i>&nbsp;TOC</p>
  <div class="toc-body" id="toc-body"></div>
</div>

      </div>
    
  </div>
</div>

<!-- Custom -->


    

    
      <a id="scroll-top-button" aria-label="TOP" href="#" role="button">
        <i class="iconfont icon-arrowup" aria-hidden="true"></i>
      </a>
    

    
      <div class="modal fade" id="modalSearch" tabindex="-1" role="dialog" aria-labelledby="ModalLabel"
     aria-hidden="true">
  <div class="modal-dialog modal-dialog-scrollable modal-lg" role="document">
    <div class="modal-content">
      <div class="modal-header text-center">
        <h4 class="modal-title w-100 font-weight-bold">Search</h4>
        <button type="button" id="local-search-close" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body mx-3">
        <div class="md-form mb-5">
          <input type="text" id="local-search-input" class="form-control validate">
          <label data-error="x" data-success="v"
                 for="local-search-input">keyword</label>
        </div>
        <div class="list-group" id="local-search-result"></div>
      </div>
    </div>
  </div>
</div>
    

    
  </main>

  <footer class="text-center mt-5 py-3">
  <div class="footer-content">
     <!-- <a href="https://hexo.io" target="_blank" rel="nofollow noopener"><span>Hexo</span></a> --> <i class="iconfont icon-bug"></i> <a href="/report/" target="_blank" rel="nofollow noopener"><span>Report Bug</span></a> 
  </div>
  

  

  
</footer>


  <!-- SCRIPTS -->
  
  <script  src="https://cdn.jsdelivr.net/npm/nprogress@0/nprogress.min.js" ></script>
  <link  rel="stylesheet" href="https://cdn.jsdelivr.net/npm/nprogress@0/nprogress.min.css" />

  <script>
    NProgress.configure({"showSpinner":false,"trickleSpeed":100})
    NProgress.start()
    window.addEventListener('load', function() {
      NProgress.done();
    })
  </script>


<script  src="https://cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js" ></script>
<script  src="https://cdn.jsdelivr.net/npm/bootstrap@4/dist/js/bootstrap.min.js" ></script>
<script  src="/js/events.js" ></script>
<script  src="/js/plugins.js" ></script>

<!-- Plugins -->


  <script  src="/js/local-search.js" ></script>



  
    <script  src="/js/img-lazyload.js" ></script>
  



  



  
    <script  src="https://cdn.jsdelivr.net/npm/tocbot@4/dist/tocbot.min.js" ></script>
  
  
    <script  src="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@3/dist/jquery.fancybox.min.js" ></script>
  
  
    <script  src="https://cdn.jsdelivr.net/npm/anchor-js@4/anchor.min.js" ></script>
  
  
    <script defer src="https://cdn.jsdelivr.net/npm/clipboard@2/dist/clipboard.min.js" ></script>
  



  <script defer src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js" ></script>




  <script  src="https://cdn.jsdelivr.net/npm/typed.js@2/lib/typed.min.js" ></script>
  <script>
    (function (window, document) {
      var typing = Fluid.plugins.typing;
      var title = document.getElementById('subtitle').title;
      
        typing(title);
      
    })(window, document);
  </script>





  

  
    <!-- MathJax -->
    <script>
      MathJax = {
        tex: {
          inlineMath: [['$', '$'], ['\\(', '\\)']]
        },
        loader: {
          load: ['ui/lazy']
        },
        options: {
          renderActions: {
            findScript: [10, doc => {
              document.querySelectorAll('script[type^="math/tex"]').forEach(node => {
                const display = !!node.type.match(/; *mode=display/);
                const math = new doc.options.MathItem(node.textContent, doc.inputJax[0], display);
                const text = document.createTextNode('');
                node.parentNode.replaceChild(text, node);
                math.start = { node: text, delim: '', n: 0 };
                math.end = { node: text, delim: '', n: 0 };
                doc.math.push(math);
              });
            }, '', false],
            insertedScript: [200, () => {
              document.querySelectorAll('mjx-container').forEach(node => {
                let target = node.parentNode;
                if (target.nodeName.toLowerCase() === 'li') {
                  target.parentNode.classList.add('has-jax');
                }
              });
            }, '', false]
          }
        }
      };
    </script>

    <script async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-svg.js" ></script>

  











<!-- 主题的启动项 保持在最底部 -->
<script  src="/js/boot.js" ></script>


</body>
</html>
